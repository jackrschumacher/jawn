<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Are you a Jawn?</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="styles.css">
        
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
        <link rel="icon" type="image/svg+xml" href="logo.svg">
    
    </head>
    <body>

        <a href="https://github.com/jackrschumacher/jawn" target="_blank" rel="noopener noreferrer" class="icon-button" id="github-link" aria-label="View on GitHub">
            <i class="bi bi-github"></i>
        </a>
        
        <button id="theme-toggle" class="icon-button" aria-label="Toggle theme">
            <i class="icon-sun bi bi-sun-fill"></i>
            <i class="icon-moon bi bi-moon-fill"></i>
        </button>

        <main class="main-content">

            <div class="column-left">
                <div class="wheel-container">
                    <div class="wheel-pointer"></div>
                    <div id="wheel">
                        <div class="wheel-text" style="--i: 0;"><span>JAWN</span></div>
                        <div class="wheel-text" style="--i: 1;"><span>NOT JAWN</span></div>
                        <div class="wheel-text flip-text" style="--i: 2;"><span>JAWN</span></div>
                        <div class="wheel-text flip-text" style="--i: 3;"><span>NOT JAWN</span></div>
                        <div class="wheel-text flip-text" style="--i: 4;"><span>JAWN</span></div>
                        <div class="wheel-text flip-text" style="--i: 5;"><span>NOT JAWN</span></div>
                        <div class="wheel-text flip-text" style="--i: 6;"><span>JAWN</span></div>
                        <div class="wheel-text" style="--i: 7;"><span>NOT JAWN</span></div>
                    </div>
                </div>
        
                <div class="input-container">
                    <h2>Who is a Jawn?</h2>
                    <textarea id="name-list-input" rows="5" placeholder="Enter names, one per line..."></textarea>
                    <button id="spin-button" class="primary-button">FIND OUT!</button>
                </div>
            </div>

            <div class="column-right">
                <div class="results-container">
                    <div class="results-header">
                        <h3 id="result-title"></h3>
                        <button class="icon-button" id="copy-button" aria-label="Copy all results">
                            <i class="icon-copy bi bi-clipboard-check"></i>
                            <i class="icon-copied bi bi-check-lg"></i>
                        </button>
                    </div>
                    <div id="results-placeholder" class="is-placeholder">Your results will appear here...</div>
                </div>
            </div>

        </main>

        <script>
            // --- Theme Toggle Script (existing) ---
            (function() {
                const themeToggleButton = document.getElementById('theme-toggle');
                const htmlElement = document.documentElement;
                const currentTheme = localStorage.getItem('theme');
                const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;

                if (currentTheme === 'dark') {
                    htmlElement.classList.add('dark-mode');
                } else if (currentTheme === 'light') {
                    htmlElement.classList.remove('dark-mode');
                } else if (prefersDark) {
                    htmlElement.classList.add('dark-mode');
                }

                themeToggleButton.addEventListener('click', function() {
                    htmlElement.classList.toggle('dark-mode');
                    if (htmlElement.classList.contains('dark-mode')) {
                        localStorage.setItem('theme', 'dark');
                    } else {
                        localStorage.setItem('theme', 'light');
                    }
                });
            })();
            
            // === Levenshtein Distance Helper (Unchanged) ===
            function getLevenshteinDistance(a, b) {
                if (a.length === 0) return b.length;
                if (b.length === 0) return a.length;
                const matrix = [];
                for (let i = 0; i <= b.length; i++) {
                    matrix[i] = [i];
                }
                for (let j = 0; j <= a.length; j++) {
                    matrix[0][j] = j;
                }
                for (let i = 1; i <= b.length; i++) {
                    for (let j = 1; j <= a.length; j++) {
                        const cost = a[j - 1] === b[i - 1] ? 0 : 1;
                        matrix[i][j] = Math.min(
                            matrix[i - 1][j] + 1,      // deletion
                            matrix[i][j - 1] + 1,      // insertion
                            matrix[i - 1][j - 1] + cost // substitution
                        );
                    }
                }
                return matrix[b.length][a.length];
            }


            // --- Wheel Spin Script (Updated) ---
            (function() {
                const wheel = document.getElementById('wheel');
                const spinButton = document.getElementById('spin-button');
                const nameInput = document.getElementById('name-list-input');
                const resultTitle = document.getElementById('result-title');
                const resultsPlaceholder = document.getElementById('results-placeholder');
                
                const copyButton = document.getElementById('copy-button');
                let allResults = [];
                
                let isSpinning = false;
                let currentRotation = 0;
                const numSlices = 8;
                const sliceAngle = 360 / numSlices; // 45 degrees

                // === MODIFIED spinForName FUNCTION ===
                function spinForName(name, duration) {
                    return new Promise((resolve) => {
                        
                        // --- UPDATED "LOOSER" JAWN LOGIC ---
                        const targetWord = "jawn";
                        const distance = getLevenshteinDistance(name.toLowerCase(), targetWord);
                        
                        // Probabilities are now higher for all distances
                        const probabilityMap = {
                            0: 1.0,  // "jawn" -> 100%
                            1: 0.95, // "john", "dawn" -> 95% (was 90%)
                            2: 0.85, // "jack", "lawn" -> 85% (was 75%)
                            3: 0.70, // "jason" -> 70% (was 50%)
                            4: 0.60, // "jackson" -> 60% (was 25%)
                            5: 0.40  // NEW: 40% (was default 10%)
                        };
                        
                        // Default probability for 6+ distance is now 20%
                        const jawnProbability = probabilityMap[distance] !== undefined ? probabilityMap[distance] : 0.20;
                        // --- END UPDATED LOGIC ---
                        
                        const isJawn = Math.random() < jawnProbability;
                        const resultString = isJawn ? 'JAWN' : 'NOT A JAWN';
                        const percentageString = Math.round(jawnProbability * 100);

                        allResults.push(`${name}: ${resultString} (${percentageString}% Jawn)`);

                        // --- Force the wheel to land on the correct result ---
                        let sliceNumber;
                        if (isJawn) {
                            const jawnSlices = [0, 2, 4, 6];
                            sliceNumber = jawnSlices[Math.floor(Math.random() * jawnSlices.length)];
                        } else {
                            const notJawnSlices = [1, 3, 5, 7];
                            sliceNumber = notJawnSlices[Math.floor(Math.random() * notJawnSlices.length)];
                        }

                        const centerOfSlice = sliceNumber * sliceAngle;
                        const randomOffset = (Math.random() * (sliceAngle - 15)) - (sliceAngle / 2 - 7.5);
                        const landAngle = centerOfSlice + randomOffset;
                        
                        const totalRotation = currentRotation + 7200 + landAngle; 

                        wheel.style.transition = `transform ${duration / 1000}s ease-out`;
                        wheel.style.transform = `rotate(${totalRotation}deg)`;

                        setTimeout(() => {
                            currentRotation = totalRotation % 360; 
                            wheel.style.transition = 'none'; 
                            wheel.style.transform = `rotate(${currentRotation}deg)`;
                            void wheel.offsetWidth; 

                            const resultLine = document.createElement('div');
                            resultLine.className = 'result-line';
                            
                            const statusSpan = document.createElement('span');
                            statusSpan.textContent = resultString;
                            statusSpan.className = isJawn ? 'status-jawn' : 'status-not-jawn';
                            
                            const percentSpan = document.createElement('span');
                            percentSpan.className = 'status-percent';
                            percentSpan.textContent = ` (${percentageString}% Jawn)`;
                            
                            resultLine.textContent = `${name}: `;
                            resultLine.appendChild(statusSpan);
                            resultLine.appendChild(percentSpan);
VScodeError: 
                            resultsPlaceholder.appendChild(resultLine);

                            resolve(); 
                        }, duration);
                    });
                }

                // === processNames FUNCTION (sets dynamic speed) ===
                async function processNames() {
                    allResults = [];
                    const names = nameInput.value.split('\n')
                                                .map(name => name.trim())
                                                .filter(name => name.length > 0);

                    if (names.length === 0) {
                        resultTitle.textContent = 'Please enter at least one name.';
                        resultsPlaceholder.classList.add('is-placeholder');
                        resultsPlaceholder.textContent = 'Please enter at least one name.';
                        isSpinning = false;
                        spinButton.disabled = false;
                        return;
                    }

                    // --- Dynamic speed logic (Unchanged) ---
                    let spinDuration = 4000;
                    let pauseDuration = 1000;
                    
                    if (names.length > 5) {
                        spinDuration = 2000;
                        pauseDuration = 500;
                    }
                    if (names.length > 10) {
                        spinDuration = 1000;
                        pauseDuration = 250;
                    }
                    // --- End speed logic ---
                    
                    for (const name of names) {
                        await spinForName(name, spinDuration); 
                        await new Promise(resolve => setTimeout(resolve, pauseDuration)); 
                    }

                    isSpinning = false;
                    spinButton.disabled = false;
                    resultTitle.textContent = 'Results:';

                    if (allResults.length > 0) {
                        copyButton.style.display = 'flex';
                    }

                    resultsPlaceholder.classList.add('animation-complete');
                    setTimeout(() => {
                        resultsPlaceholder.classList.remove('animation-complete');
                    }, 600); 
                }

                spinButton.addEventListener('click', function() {
                    if (isSpinning) return;

                    isSpinning = true;
                    spinButton.disabled = true;
                    resultsPlaceholder.innerHTML = ''; 
                    resultsPlaceholder.classList.remove('is-placeholder');
                    resultTitle.textContent = 'Spinning...';
                    
                    copyButton.style.display = 'none';
                    copyButton.classList.remove('copied');

                    processNames();
                });

                copyButton.addEventListener('click', function() {
                    const textToCopy = allResults.join('\n');
                    navigator.clipboard.writeText(textToCopy).then(() => {
                        copyButton.classList.add('copied');
                        setTimeout(() => {
                            copyButton.classList.remove('copied');
                        }, 2000);
                    }).catch(err => {
                        console.error('Failed to copy names: ', err);
                    });
                });
            })();

            // --- Mouse Position Tracker (existing) ---
            (function() {
                const html = document.documentElement;
                window.addEventListener('mousemove', (e) => {
                    requestAnimationFrame(() => {
                        const xPercent = (e.clientX / window.innerWidth) - 0.5;
                        const yPercent = (e.clientY / window.innerHeight) - 0.5;
                        html.style.setProperty('--mouse-x-percent', xPercent);
                        html.style.setProperty('--mouse-y-percent', yPercent);
                    });
                });
            })();
        </script>
    </body>
</html>